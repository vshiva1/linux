/*
 * Intel Cache Quality-of-Service Monitoring (CQM) support.
 *
 * A Resource Manager ID (RMID) is a u32 value that, when programmed in a
 * logical CPU, will allow the LLC cache to associate the changes in occupancy
 * generated by that cpu (cache lines allocations - deallocations) to the RMID.
 * If a RMID has been assigned to a thread T long enough for all cache lines
 * used by T to be allocated, then the occupancy reported by the hardware
 * equals the total cache occupancy for T.
 *
 * Groups of threads that are to be monitored together (such as cgroups
 * or processes) can shared a RMID.
 *
 * This driver implements a tree hierarchy of Monitored Resources (monr). Each
 * monr is a cgroup, a process or a thread that needs one single RMID.
 *
 * Since the number of RMIDs is relatively small to the number of potential
 * monitored elements, RMIDs must be "rotated" among all monitored elements.
 */

#include <linux/perf_event.h>
#include <asm/pqr_common.h>
#include <asm/topology.h>

/*
 * Time between execution of rotation logic. The frequency of execution does
 * not affect the rate at which RMIDs are recycled, except by the delay by the
 * delay updating the prmid's and their pools.
 * The rotation period is stored in pmu->hrtimer_interval_ms.
 */
#define CQM_DEFAULT_ROTATION_PERIOD 1200	/* ms */
